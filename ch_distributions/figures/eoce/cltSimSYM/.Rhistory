				cat("Randomizing, please wait...", "\n")#
				if(type1 == "quantitative"){#
					for(i in 1:nsim){sim[,i] = sample(var1, n, replace = TRUE)}#
					sim_dist_temp = apply(sim, 2, statistic)#
					if(est == "mean"){#
						# Hypotheses#
						cat(paste("H0: mu =", null, "\n"))#
						cat(paste("HA: mu", sign, null, "\n"))#
						sim_dist = sim_dist_temp - (mean(sim_dist_temp) - null)#
						#cat(mean(sim_dist))#
					}#
										#
					if(est == "median"){#
						cat(paste("H0: median =", null, "\n"))#
						cat(paste("HA: median", sign, null, "\n"))#
						sim_dist = sim_dist_temp - (median(sim_dist_temp) - null)#
						#cat(median(sim_dist))#
					}					#
				}#
				if(type1 == "categorical"){#
					cat(paste("H0: p =", null, "\n"))#
					cat(paste("HA: p", sign, null, "\n"))#
					sim_dist = rbinom(nsim, n, prob = null) / n#
				}#
				#
				smaller.tail = round(min(c(mean(sim_dist <= actual), mean(sim_dist >= actual))), 4)	#
				#
				if(nsim > 500){#
					counts = hist(sim_dist, plot = FALSE)$counts  #
					hist(sim_dist, main = "Randomization distribution", xlab = "randomization statistic", ylim = c(0, 1.4 * max(counts)))  #
				}#
				if(nsim <= 500){#
					counts = BHH2::dotPlot(sim_dist, main = "Randomization distribution", xlab = "randomization statistic")$y#
				}				#
				#
			    alternative = match.arg(alternative)#
#
				if(alternative == "less"){#
					if(actual < null){cat(paste("p-value: ", smaller.tail,"\n"))}				#
					if(actual > null){cat(paste("p-value: ", 1 - smaller.tail,"\n"))}#
					lines(x = c(actual,actual), y = c(0,1.1*max(counts)), col="#225588", lwd=2)#
				}#
				if(alternative == "greater"){#
					if(actual < null){cat(paste("p-value: ", 1 - smaller.tail,"\n"))}				#
					if(actual > null){cat(paste("p-value: ", smaller.tail,"\n"))}#
					lines(x = c(actual,actual), y = c(0,1.1*max(counts)), col="#225588", lwd=2)#
				}#
				if(alternative == "twosided"){#
					cat(paste("p-value: ", smaller.tail * 2,"\n"))#
					lines(x = c(actual,actual), y = c(0,1.1*max(counts)), col="#225588", lwd=2)#
					if(actual >= null){#
						temp = actual - null#
						lines(x = c(null - temp,null - temp), y = c(0,1.1*max(counts)), col = "#225588", lwd=2)						#
					}#
					if(actual < null){#
						temp = null - actual#
						lines(x = c(null + temp,null + temp), y = c(0,1.1*max(counts)), col = "#225588", lwd=2)						#
					}		#
				}#
			  	text(x = actual, y = 1.2*max(counts), paste("observed =", round(actual,2)), col = "#225588", cex = 0.8)											#
			}		#
		}#
		#
		# theoretical#
		if(method == "theoretical"){#
			#
			# confidence interval#
			if(type == "ci"){#
				if(type1 == "quantitative"){#
					if(est == "median"){stop("Use simulation methods for inference for the median.")}#
					if(est == "mean"){#
						# check conditions#
						hist(var1, main = "Histogram of sample data", xlab = "sample data")	#
						cat("Check histogram to verify that sample data do not come from an extremely skewed distribution.\n")#
						# calculate me and se#
						se = sd(var1) / sqrt(n)#
						cat(paste("Standard error: ", round(se, 4), "\n"))#
						if(n >= 50) {critvalue = qnorm( (1 - conflevel)/2 + conflevel )}#
						if(n < 50) {critvalue = qt( (1 - conflevel)/2 + conflevel , df = n - 1)}					#
					}#
				}#
				if(type1 == "categorical"){#
					# check conditions#
					suc = round(n * actual, 2)#
					fail = round(n * (1 - actual), 2)#
					cat(paste("Number of expected successes: ", suc, ";", "Number of expected failures: ", fail), "\n")	#
					if(suc < 10 || fail < 10){#
						stop("There aren't at least 10 successes and 10 failures, use simulation methods instead.")#
					}#
					# calculate me and se#
					se = sqrt(actual * (1-actual) / n)#
					cat(paste("Standard error: ", round(se, 4), "\n"))#
					critvalue = qnorm( (1 - conflevel)/2 + conflevel )					#
				}#
				me = critvalue * se#
				ci = c(actual - me , actual + me)#
				cat(c(conflevel*100, "% Confidence interval = (", round(ci[1],2), ",", round(ci[2],2), ")\n"))	#
			}#
			#
			# hypothesis test#
			if(type == "ht"){#
				if(type1 == "quantitative"){#
					if(est == "median"){stop("Use simulation methods for inference for the median.")}#
					if(est == "mean"){#
						# Hypotheses#
						cat(paste("H0: mu =", null, "\n"))#
						cat(paste("HA: mu", sign, null, "\n"))#
						#
						# check conditions#
						par(mfrow = c(1,2))#
						hist(var1, main = "Histogram of sample data", xlab = "sample data")	#
						cat("Check histogram to verify that sample data do not come from an extremely skewed distribution.\n")#
						# calculate test statistic and p-value component#
						se = sd(var1) / sqrt(n)#
						teststat = (actual - null)/se#
						if(n >= 50){#
							cat(paste("Test statistic: Z = ", round(teststat, 3),"\n"))#
							smaller.tail = round(min(pnorm(teststat), pnorm(teststat, lower.tail = FALSE)), 4)#
							}#
						if(n < 50){#
							cat(paste("Test statistic: T = ", round(teststat, 3),"\n"))#
							cat(paste("Degrees of freedom: ", n - 1, "\n"))#
							smaller.tail = round(min(pt(teststat, df = n - 1), pt(teststat, df = n - 1, lower.tail = FALSE)), 4)#
							}		#
					}#
				}#
				if(type1 == "categorical"){#
					if(null < 0 || null > 1){#
						stop("Null value should be a proportion between 0 and 1.")#
					}#
					# Hypotheses#
					cat(paste("H0: p =", null, "\n"))#
					cat(paste("HA: p", sign, null, "\n"))#
					#
					#
					# check conditions#
					exp_suc = round(n * null, 2)#
					exp_fail = round(n * (1 - null), 2)#
					cat(paste("Number of expected successes: ", exp_suc, ";", "Number of expected failures: ", exp_fail), "\n")#
					if(exp_suc < 10 || exp_fail < 10){#
						stop("There aren't at least 10 expected successes and 10 expected failures, use simulation methods instead.")#
					}#
					# calculate test statistic and p-value#
					se = sqrt(null * (1 - null) / n)#
					teststat = (actual - null)/se#
					cat(paste("Test statistic: Z = ", round(teststat, 3),"\n"))#
					smaller.tail = round(min(pnorm(teststat), pnorm(teststat, lower.tail = FALSE)), 4)					#
				}#
#
				# alternative = less#
				if(alternative == "less"){#
					if(actual < null){cat(paste("p-value: ", smaller.tail,"\n"))}				#
					if(actual > null){cat(paste("p-value: ", 1 - smaller.tail,"\n"))}#
					normTail(L = teststat, axes = FALSE, col = "#22558833")#
					axis(1, at = c(-3, teststat, 0, 3), labels = c(NA, paste(round(actual,2)), paste(null), NA))#
				}#
#
				# alternative = greater#
				if(alternative == "greater"){#
					if(actual < null){cat(paste("p-value: ", 1 - smaller.tail,"\n"))}				#
					if(actual > null){cat(paste("p-value: ", smaller.tail,"\n"))}#
					normTail(U = teststat, axes = FALSE, col = "#22558833")#
					axis(1, at = c(-3, 0, teststat, 3), labels = c(NA, paste(null), paste(round(actual,2)), NA))#
				}#
				#
				# alternative = twosided	#
				if(alternative == "twosided"){#
					cat(paste("p-value: ", smaller.tail * 2,"\n"))#
					if(actual < null){#
						normTail(L = teststat, U = -1*teststat, axes = FALSE, col = "#22558833")#
						axis(1, at = c(-3, teststat, 0, -1*teststat, 3), labels = c(NA, paste(round(actual,2)), paste(null), paste(round(null + (null - actual), 2)), NA))#
					}#
					if(actual > null){#
						normTail(L = -1*teststat, U = teststat, axes = FALSE, col = "#22558833")#
						axis(1, at = c(-3, -1*teststat, 0, teststat, 3), labels = c(NA, paste(round(null - (actual - null), 2)), paste(null), paste(round(actual,2)), NA))#
					}				#
				}#
			}#
		}#
	# two variables#
	}#
	par(mfrow = c(1,1))#
}
inference(f, est = "mean", type = "ht", method = "simulation", nsim = 1000, null = 0.12, alternative = "less")
# inference#
inference <- function(var1, var2 = NULL, est = c("mean", "median", "proportion"), outcome = NULL, order = NA, nsim = 10000, conflevel = 0.95, null = NULL, alternative = c("less","greater","twosided"), type = c("ci","ht"), method = c("theoretical","simulation")){#
	# var1: variable 1, can be numeric or categorical#
	# var2: variable 2, categorical#
	# est: parameter to estimate, mean, median, or mode#
	# outcome: which outcome of the categorical variable to do inference on#
	# order: when var2 is given, order of groups in which to subtract parameters#
	# nsim: number of simulations#
	# level: confidence level, value between 0 and 1#
	#
	# load openintro package#
	if(!("openintro" %in% names(installed.packages()[,"Package"]))){install.packages("openintro")}#
	if(!("BHH2" %in% names(installed.packages()[,"Package"]))){install.packages("openintro")}#
	library(openintro)#
	library(BHH2)#
		#
	# possible error: weird data#
	if(length(var1) == 1){stop("Sample size is only 1, check input.")}#
	#
	# possible error: missing arguments#
	if(length(est) > 1){stop("Missing estimate: mean, median, or proportion")}#
	if(length(type) > 1){stop("Missing type: confidence interval or hypothesis test")}#
	if(length(method) > 1){stop("Missing method: theoretical or simulation")}#
	#
	if(type == "ht" & is.null(null)){stop("Missing null value")}#
	if(type == "ht" & length(alternative) > 1){stop("Missing alternative: less, greater, or twosided")}#
	#
	# possible error: variables not of same length#
	if (!is.null(var2)){#
		if (length(var1) != length(var2)) {stop("The two variables must be of the same length.")}#
	}#
	#
	# possible error: confidence level greater than 1#
	if(conflevel > 1){conflevel = conflevel / 100}#
		#
	# possible error: drop NAs, and if var2 is given, use pairwise complete#
	if (is.null(var2)) {#
    	if (sum(is.na(var1)) > 0) {var1 = var1[!is.na(var1)]}#
  	}#
	if (!is.null(var2)) {#
    	if (sum(is.na(var1)) > 0 | sum(is.na(var2)) > 0) {#
      		var1.temp = var1[!is.na(var1) & !is.na(var2)]#
      		var2.temp = var2[!is.na(var1) & !is.na(var2)]#
      		var1 = var1.temp#
      		var2 = var2.temp#
    	}#
  	}#
#
	# set variable type for var1#
	type1 = "categorical"#
  	if (is.numeric(var1)) {type1 = "quantitative"}#
	#
	# print variable types#
	if (!is.null(var2)) {#
    	type2 = "categorical"#
    	if(is.numeric(var2)){#
			type2 = "quantitative"#
    		cat(paste("Variable 1:", type1, ", Variable 2:", type2, "\n"))#
			}#
  		}#
	if (is.null(var2)) {#
    	type2 = "only1var"#
    	cat(paste("One", type1, "variable", "\n"))#
  	}#
#
	# the quantitative variable should be var1 if one categorical and one quantitative#
  	if (type1 == "categorical" & type2 == "quantitative") {#
    	var1.temp = var2#
    	var2.temp = var1#
    	var1 = var1.temp#
    	var2 = var2.temp#
    	type1 = "quantitative"#
    	type2 = "categorical"#
  	}#
#
	# possible error: wrong estimate#
	if(type1 == "quantitative" & est == "proportion"){#
		stop("Variable is quantitative, sample statistic cannot be a proportion, choose either mean or median")#
	}#
	#
	if(type1 == "categorical" & est == "mean"){#
		stop("Variable is categorical, sample statistic cannot be a mean or a median, use proportion")#
	}#
	if(type1 == "categorical" & est == "median"){#
		stop("Variable is categorical, sample statistic cannot be a mean or a median, use proportion")#
	}#
	#
	# possible error: outcome not defined for categorical variable#
	if(type1 == "categorical" & is.null(outcome)){#
		stop("Variable is categorical, please specify which outcome you are interested in.")#
	}#
	#
	# define sample size#
	n = length(var1)#
	#
	# define sign of hypothesis test#
	if(type == "ht"){#
		if(alternative == "less"){sign = "<"}#
		if(alternative == "greater"){sign = ">"}#
		if(alternative == "twosided"){sign = "!="}		#
	}#
#
	# one variable#
	if(type2 == "only1var"){#
		cat("Single", est, "\n")#
		# set statistic: mean, median, or proportion#
		if(type1 == "quantitative"){statistic = match.fun(est)}#
		if(type1 == "categorical"){statistic = function(var1){sum(var1 == outcome)/n}}#
	#
		actual = statistic(var1)#
		cat(paste("Observed ", est, sep = "", ": ", round(actual, 2)), "\n")#
		#
		# simulation#
		if(method == "simulation"){#
			sim = matrix(NA, nrow = n, ncol = nsim)#
			#
			# bootstrap ci#
			if(type == "ci"){#
				cat("Bootstrapping, please wait...", "\n")#
				for(i in 1:nsim){sim[,i] = sample(var1, n, replace = TRUE)}#
				sim_dist = apply(sim, 2, statistic)#
#
				ci = quantile(sim_dist, c( (1 - conflevel)/2 , ((1 - conflevel)/2)+conflevel ))#
				#
				if(nsim > 500){#
					counts = hist(sim_dist, plot = FALSE)$counts  #
					hist(sim_dist, main = "Bootstrap distribution", xlab = "bootstrap statistic")  #
				}#
				if(nsim <= 500){#
					counts = BHH2::dotPlot(sim_dist, main = "Bootstrap distribution", xlab = "bootstrap statistic")$y#
				}#
				#
				for (i in 1:2) {#
			    	segments(ci[i], 0, ci[i], 0.8 * max(counts), col="#225588", lwd=2)#
			    	text(round(ci[i],2), max(counts), pos=1, col="#225588", round(ci[i],2))#
			  	}#
#
				cat(c(conflevel*100, "% Bootstrap interval = (", round(ci[1],2), ",", round(ci[2],2), ")\n"))		#
			}#
			#
			# randomization test#
			if(type == "ht"){#
				cat("Randomizing, please wait...", "\n")#
				if(type1 == "quantitative"){#
					for(i in 1:nsim){sim[,i] = sample(var1, n, replace = TRUE)}#
					sim_dist_temp = apply(sim, 2, statistic)#
					if(est == "mean"){#
						# Hypotheses#
						cat(paste("H0: mu =", null, "\n"))#
						cat(paste("HA: mu", sign, null, "\n"))#
						sim_dist = sim_dist_temp - (mean(sim_dist_temp) - null)#
						#cat(mean(sim_dist))#
					}#
										#
					if(est == "median"){#
						cat(paste("H0: median =", null, "\n"))#
						cat(paste("HA: median", sign, null, "\n"))#
						sim_dist = sim_dist_temp - (median(sim_dist_temp) - null)#
						#cat(median(sim_dist))#
					}					#
				}#
				if(type1 == "categorical"){#
					cat(paste("H0: p =", null, "\n"))#
					cat(paste("HA: p", sign, null, "\n"))#
					sim_dist = rbinom(nsim, n, prob = null) / n#
				}#
				#
				smaller.tail = round(min(c(mean(sim_dist <= actual), mean(sim_dist >= actual))), 4)	#
				#
				if(nsim > 500){#
					counts = hist(sim_dist, plot = FALSE)$counts  #
					hist(sim_dist, main = "Randomization distribution", xlab = "randomization statistic", ylim = c(0, 1.3 * max(counts)))  #
				}#
				if(nsim <= 500){#
					counts = BHH2::dotPlot(sim_dist, main = "Randomization distribution", xlab = "randomization statistic")$y#
				}				#
				#
			    alternative = match.arg(alternative)#
#
				if(alternative == "less"){#
					if(actual < null){cat(paste("p-value: ", smaller.tail,"\n"))}				#
					if(actual > null){cat(paste("p-value: ", 1 - smaller.tail,"\n"))}#
					lines(x = c(actual,actual), y = c(0,1.1*max(counts)), col="#225588", lwd=2)#
				}#
				if(alternative == "greater"){#
					if(actual < null){cat(paste("p-value: ", 1 - smaller.tail,"\n"))}				#
					if(actual > null){cat(paste("p-value: ", smaller.tail,"\n"))}#
					lines(x = c(actual,actual), y = c(0,1.1*max(counts)), col="#225588", lwd=2)#
				}#
				if(alternative == "twosided"){#
					cat(paste("p-value: ", smaller.tail * 2,"\n"))#
					lines(x = c(actual,actual), y = c(0,1.1*max(counts)), col="#225588", lwd=2)#
					if(actual >= null){#
						temp = actual - null#
						lines(x = c(null - temp,null - temp), y = c(0,1.1*max(counts)), col = "#225588", lwd=2)						#
					}#
					if(actual < null){#
						temp = null - actual#
						lines(x = c(null + temp,null + temp), y = c(0,1.1*max(counts)), col = "#225588", lwd=2)						#
					}		#
				}#
			  	text(x = actual, y = 1.2*max(counts), paste("observed =", round(actual,2)), col = "#225588", cex = 0.8)											#
			}		#
		}#
		#
		# theoretical#
		if(method == "theoretical"){#
			#
			# confidence interval#
			if(type == "ci"){#
				if(type1 == "quantitative"){#
					if(est == "median"){stop("Use simulation methods for inference for the median.")}#
					if(est == "mean"){#
						# check conditions#
						hist(var1, main = "Histogram of sample data", xlab = "sample data")	#
						cat("Check histogram to verify that sample data do not come from an extremely skewed distribution.\n")#
						# calculate me and se#
						se = sd(var1) / sqrt(n)#
						cat(paste("Standard error: ", round(se, 4), "\n"))#
						if(n >= 50) {critvalue = qnorm( (1 - conflevel)/2 + conflevel )}#
						if(n < 50) {critvalue = qt( (1 - conflevel)/2 + conflevel , df = n - 1)}					#
					}#
				}#
				if(type1 == "categorical"){#
					# check conditions#
					suc = round(n * actual, 2)#
					fail = round(n * (1 - actual), 2)#
					cat(paste("Number of expected successes: ", suc, ";", "Number of expected failures: ", fail), "\n")	#
					if(suc < 10 || fail < 10){#
						stop("There aren't at least 10 successes and 10 failures, use simulation methods instead.")#
					}#
					# calculate me and se#
					se = sqrt(actual * (1-actual) / n)#
					cat(paste("Standard error: ", round(se, 4), "\n"))#
					critvalue = qnorm( (1 - conflevel)/2 + conflevel )					#
				}#
				me = critvalue * se#
				ci = c(actual - me , actual + me)#
				cat(c(conflevel*100, "% Confidence interval = (", round(ci[1],2), ",", round(ci[2],2), ")\n"))	#
			}#
			#
			# hypothesis test#
			if(type == "ht"){#
				if(type1 == "quantitative"){#
					if(est == "median"){stop("Use simulation methods for inference for the median.")}#
					if(est == "mean"){#
						# Hypotheses#
						cat(paste("H0: mu =", null, "\n"))#
						cat(paste("HA: mu", sign, null, "\n"))#
						#
						# check conditions#
						par(mfrow = c(1,2))#
						hist(var1, main = "Histogram of sample data", xlab = "sample data")	#
						cat("Check histogram to verify that sample data do not come from an extremely skewed distribution.\n")#
						# calculate test statistic and p-value component#
						se = sd(var1) / sqrt(n)#
						teststat = (actual - null)/se#
						if(n >= 50){#
							cat(paste("Test statistic: Z = ", round(teststat, 3),"\n"))#
							smaller.tail = round(min(pnorm(teststat), pnorm(teststat, lower.tail = FALSE)), 4)#
							}#
						if(n < 50){#
							cat(paste("Test statistic: T = ", round(teststat, 3),"\n"))#
							cat(paste("Degrees of freedom: ", n - 1, "\n"))#
							smaller.tail = round(min(pt(teststat, df = n - 1), pt(teststat, df = n - 1, lower.tail = FALSE)), 4)#
							}		#
					}#
				}#
				if(type1 == "categorical"){#
					if(null < 0 || null > 1){#
						stop("Null value should be a proportion between 0 and 1.")#
					}#
					# Hypotheses#
					cat(paste("H0: p =", null, "\n"))#
					cat(paste("HA: p", sign, null, "\n"))#
					#
					#
					# check conditions#
					exp_suc = round(n * null, 2)#
					exp_fail = round(n * (1 - null), 2)#
					cat(paste("Number of expected successes: ", exp_suc, ";", "Number of expected failures: ", exp_fail), "\n")#
					if(exp_suc < 10 || exp_fail < 10){#
						stop("There aren't at least 10 expected successes and 10 expected failures, use simulation methods instead.")#
					}#
					# calculate test statistic and p-value#
					se = sqrt(null * (1 - null) / n)#
					teststat = (actual - null)/se#
					cat(paste("Test statistic: Z = ", round(teststat, 3),"\n"))#
					smaller.tail = round(min(pnorm(teststat), pnorm(teststat, lower.tail = FALSE)), 4)					#
				}#
#
				# alternative = less#
				if(alternative == "less"){#
					if(actual < null){cat(paste("p-value: ", smaller.tail,"\n"))}				#
					if(actual > null){cat(paste("p-value: ", 1 - smaller.tail,"\n"))}#
					normTail(L = teststat, axes = FALSE, col = "#22558833")#
					axis(1, at = c(-3, teststat, 0, 3), labels = c(NA, paste(round(actual,2)), paste(null), NA))#
				}#
#
				# alternative = greater#
				if(alternative == "greater"){#
					if(actual < null){cat(paste("p-value: ", 1 - smaller.tail,"\n"))}				#
					if(actual > null){cat(paste("p-value: ", smaller.tail,"\n"))}#
					normTail(U = teststat, axes = FALSE, col = "#22558833")#
					axis(1, at = c(-3, 0, teststat, 3), labels = c(NA, paste(null), paste(round(actual,2)), NA))#
				}#
				#
				# alternative = twosided	#
				if(alternative == "twosided"){#
					cat(paste("p-value: ", smaller.tail * 2,"\n"))#
					if(actual < null){#
						normTail(L = teststat, U = -1*teststat, axes = FALSE, col = "#22558833")#
						axis(1, at = c(-3, teststat, 0, -1*teststat, 3), labels = c(NA, paste(round(actual,2)), paste(null), paste(round(null + (null - actual), 2)), NA))#
					}#
					if(actual > null){#
						normTail(L = -1*teststat, U = teststat, axes = FALSE, col = "#22558833")#
						axis(1, at = c(-3, -1*teststat, 0, teststat, 3), labels = c(NA, paste(round(null - (actual - null), 2)), paste(null), paste(round(actual,2)), NA))#
					}				#
				}#
			}#
		}#
	# two variables#
	}#
	par(mfrow = c(1,1))#
}
inference(f, est = "mean", type = "ht", method = "simulation", nsim = 1000, null = 0.12, alternative = "less")
inference(f, est = "mean", type = "ht", method = "simulation", nsim = 100, null = 0.12, alternative = "less")
q()
hist(rgamma(10000000, shape=1.777666, scale=30/1.777666))
hist(rgamma(10000, shape=1.777666, scale=30/1.777666))
hist(rgamma(10000, shape=30/1.777666, scale=1.777666))
hist(rgamma(10000, shape=30/1.777666, scale=0.5))
hist(rgamma(10000, shape=30/1.777666, scale=1.5))
5
hist(rgamma(10000, shape=50/1.777666, scale=1.5))
?rbeta
hist(rbeta(10000, shape=54.5, scale=2))
hist(rbeta(10000, 4.5, 2))
hist(rbeta(10000, 4.5*80, 2*80))
hist(rbeta(10000, 4.5*70, 2*80))
hist(rbeta(10000, 4.5, 4.5*69/70))
hist(rbeta(10000, 4.5*80, 2*80))
hist(rbeta(10000, 4.5, 2))
a = rbeta(10000, 4.5, 2)
a
mean(a)
70/.69
b = a * 101.45
hist(b)
d = b[b<=100]
hist(d)
mean(d)
sd(d)
par(mar=c(4,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(b col="#22558833", border="#225588", xlab = "scores", main = "", probability = TRUE, ylab = "Relative frequency")
par(mar=c(4,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(b, col="#22558833", border="#225588", xlab = "scores", main = "", probability = TRUE, ylab = "Relative frequency")
hist(b, col="#22558833", border="#225588", xlab = "scores", main = "", probability = TRUE, ylab = "Relative frequency")#
axis(1)#
axis(2, at = seq(0,0.02,0.005), labels = seq(0,0.02,0.005)*5)
hist(b, col="#22558833", border="#225588", xlab = "scores", main = "", probability = TRUE, ylab = "Relative frequency", axes = FALSE)#
axis(1)#
axis(2, at = seq(0,0.02,0.005), labels = seq(0,0.02,0.005)*5)
? densityplot
install.packages("lattive")
install.packages("lattice")
densityplot(d)
? densityplot
?? densityplot
densityPlot(d)
library(openintro)
densityPlot(d)
?densityPlot
densityPlot(d, bw = 4)
densityPlot(d, bw = 10)
densityPlot(d, bw = 5)
?densityPlot
densityPlot(d, bw = 5, from = 0, to = 100)
densityPlot(b, bw = 5, from = 0, to = 100)
set.seed(7563)#
a  = rbeta(10000, 4.5, 2)#
b = a * 100#
d = b[b<=100]
densityPlot(d, bw = 5, from = 0, to = 100)
densityPlot(b, bw = 5, from = 0, to = 100)
set.seed(7563)#
a  = rbeta(10000, 4.5, 2)#
b = a * 99
densityPlot(b, bw = 5, from = 0, to = 100)
#
set.seed(7563)#
a  = rbeta(10000, 4.5, 2)#
b = a * 90
densityPlot(b, bw = 5, from = 0, to = 100)
?densityPlot
densityPlot(b, bw = 5, from = 0, to = 100, col = "#225588")
densityPlot(b, bw = 5, from = 0, to = 100, col = "#225588", fading = 33)
densityPlot(b, bw = 5, from = 0, to = 100, col = "#225588", fading = "33")
densityPlot(b, bw = 5, from = 0, to = 100, col = "#225588", fadingBorder = "33")
?density
densityPlot(b, bw = 5, from = 0, to = 100, col = "#225588", fadingBorder = "33", histo = TRUE)
?densityPlot
densityPlot(b, bw = 5, from = 0, to = 100, col = "#225588", fadingBorder = "33", histo = "faded")
set.seed(7563)#
a  = rbeta(10000, 4.5, 2)#
b = a * 99
densityPlot(b, bw = 5, from = 0, to = 100, col = "#225588", fadingBorder = "33", histo = "faded")
set.seed(7563)#
a  = rbeta(10000, 4.5, 2)#
b = a * 95
densityPlot(b, bw = 5, from = 0, to = 100, col = "#225588", fadingBorder = "33", histo = "faded")
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded")
set.seed(7563)#
a  = rbeta(10000, 4.5, 2)#
b = a * 95
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded")
setwd("/Users/mine/Desktop/Teaching/Sta 101 - S12/Exams/Midterm 1/figures/scores")
#
pdf("scores_pop.pdf", height = 3, width = 5)#
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded")#
dev.off()
pdf("scores_pop.pdf", height = 4, width = 5)#
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded")#
dev.off()
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")#
axis(1)
text(x = 10, y = 0.005, "Population")
text(x = 10, y = 0.025, "Population")
text(x = 10, y = 0.015, "Population")
mean(b)
text(x = 10, y = 0.01, expression(paste(mu, "= 66")))
sd(b)
text(x = 10, y = 0.01, expression(paste(sigma, "= 16")))
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")#
axis(1)#
text(x = 10, y = 0.015, "Population")#
text(x = 10, y = 0.0125, expression(paste(mu, "= 66")))#
text(x = 10, y = 0.01, expression(paste(sigma, "= 16")))
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")#
axis(1)#
text(x = 10, y = 0.015, "Population")#
text(x = 10, y = 0.0125, expression(paste(mu, " = 66")))#
text(x = 10, y = 0.01, expression(paste(sigma, " = 16")))
pdf("scores_pop.pdf", height = 5, width = 5)#
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")#
axis(1)#
text(x = 10, y = 0.015, "Population")#
text(x = 10, y = 0.0125, expression(paste(mu, " = 66")))#
text(x = 10, y = 0.01, expression(paste(sigma, " = 16")))#
dev.off()
par(mar=c(2,0,0,0), mgp=c(2.7,0.7,0), las = 1)#
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")#
axis(1)#
text(x = 10, y = 0.015, "Population")#
text(x = 10, y = 0.0125, expression(paste(mu, " = 66")))#
text(x = 10, y = 0.01, expression(paste(sigma, " = 16")))
pdf("scores_pop.pdf", height = 5, width = 5)#
par(mar=c(2,0,0,0), mgp=c(2.7,0.7,0), las = 1)#
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")#
axis(1)#
text(x = 10, y = 0.015, "Population")#
text(x = 10, y = 0.0125, expression(paste(mu, " = 66")))#
text(x = 10, y = 0.01, expression(paste(sigma, " = 16")))#
dev.off()
pdf("scores_pop.pdf", height = 4, width = 5)#
par(mar=c(2,0,0,0), mgp=c(2.7,0.7,0), las = 1)#
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")#
axis(1)#
text(x = 10, y = 0.015, "Population")#
text(x = 10, y = 0.0125, expression(paste(mu, " = 66")))#
text(x = 10, y = 0.01, expression(paste(sigma, " = 16")))#
dev.off()
pdf("scores_pop.pdf", height = 3.5, width = 5)#
par(mar=c(2,0,0,0), mgp=c(2.7,0.7,0), las = 1)#
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")#
axis(1)#
text(x = 10, y = 0.015, "Population")#
text(x = 10, y = 0.0125, expression(paste(mu, " = 66")))#
text(x = 10, y = 0.01, expression(paste(sigma, " = 16")))#
dev.off()
set.seed(2452)#
samp = sample(b, size = 500)
hist(samp, col="#22558833", border="#225588", xlab = "", main = "", axes = FALSE)
par(mar=c(4,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "", main = "")
par(mar=c(2,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "", main = "")
set.seed(24524)#
#
sampling_25 = rep(0, 500)#
n = 25#
#
for(i in 1:500){#
  	temp <- sample(b, n)#
   	sampling_25[i] <- mean(temp)#
   	}
par(mar=c(2,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_25, col="#22558833", border="#225588", xlab = "", main = "")
sd(sampling_25)
sd(b)
16/5
16/4
sampling_16 = rep(0, 500)#
n = 6#
#
for(i in 1:500){#
  	temp <- sample(b, n)#
   	sampling_16[i] <- mean(temp)#
   	}
par(mar=c(2,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_25, col="#22558833", border="#225588", xlab = "", main = "")
mean(b)
66+12
hist(sampling_16, col="#22558833", border="#225588", xlab = "", main = "")
sampling_16 = rep(0, 500)#
n = 16
for(i in 1:500){#
  	temp <- sample(b, n)#
   	sampling_16[i] <- mean(temp)#
   	}
par(mar=c(2,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_16, col="#22558833", border="#225588", xlab = "", main = "")
16-12
66-12
66+12
set.seed(24524)#
#
sampling_16 = rep(0, 500)#
n = 16#
#
for(i in 1:500){#
  	temp <- sample(b, n)#
   	sampling_16[i] <- mean(temp)#
   	}#
#
pdf("scores_sampling_16.pdf", height = 3, width = 5)#
par(mar=c(2,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_16, col="#22558833", border="#225588", xlab = "", main = "")#
dev.off()
#
set.seed(3563)#
#
sampling_64 = rep(0, 500)#
n = 64#
#
for(i in 1:500){#
  	temp <- sample(b, n)#
   	sampling_64[i] <- mean(temp)#
   	}#
#
pdf("scores_sampling_64.pdf", height = 3, width = 5)#
par(mar=c(2,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_64, col="#22558833", border="#225588", xlab = "", main = "")#
dev.off()
pdf("scores_samp.pdf", height = 3, width = 5)#
par(mar=c(2,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "", main = "")#
dev.off()
hist(samp, col="#22558833", border="#225588", xlab = "", main = "", cex.axis = 1.5)
pdf("scores_samp.pdf", height = 3, width = 5)#
par(mar=c(2,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "", main = "", cex.axis = 1.5)#
dev.off()
pdf("scores_sampling_16.pdf", height = 3, width = 5)#
par(mar=c(2,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_16, col="#22558833", border="#225588", xlab = "", main = "", cex.axis = 1.5)#
dev.off()
pdf("scores_sampling_64.pdf", height = 3, width = 5)#
par(mar=c(2,3.75,0.5,0), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_64, col="#22558833", border="#225588", xlab = "", main = "", cex.axis = 1.5)#
dev.off()
#
pdf("scores_samp.pdf", height = 3, width = 5)#
par(mar=c(2,3.75,0.5,0.1), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "", main = "", cex.axis = 1.5)#
dev.off()
pdf("scores_samp.pdf", height = 3, width = 5)#
par(mar=c(2,3.75,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "", main = "", cex.axis = 1.5)#
dev.off()
hist(samp, col="#22558833", border="#225588", xlab = "", main = "", cex.axis = 1.5, cex.lab = 1.5)
pdf("scores_samp.pdf", height = 3, width = 5)#
par(mar=c(2,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()
pdf("scores_sampling_16.pdf", height = 3, width = 5)#
par(mar=c(2,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_16, col="#22558833", border="#225588", xlab = "", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()
#
pdf("scores_sampling_64.pdf", height = 3, width = 5)#
par(mar=c(2,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_64, col="#22558833", border="#225588", xlab = "", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()
mean(b)
sd(b)
18.5-14.9
18.5+ 3.6
age_at_marr = fwfdata$FMAR1AGE[!is.na(fwfdata$FMAR1AGE)]#
#
set.seed(8537)#
samp = sample(age_at_marr, size = 150, replace = FALSE)#
#
n = length(samp)#
#
xbar = mean(samp)#
#
s = sd(samp)
n
pdf("age_at_marr_hist.pdf", height = 3, width = 5)#
par(mar=c(4,3.75,0.5,0.5), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "age at first marriage of females", main = "")#
dev.off()
setwd("/Users/mine/Desktop/Teaching/Sta 101 - S12/Exams/Midterm 1/figures/age_at_marr")
pdf("age_at_marr_hist.pdf", height = 3, width = 5)#
par(mar=c(4,3.75,0.5,0.5), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "age at first marriage of females", main = "")#
dev.off()
par(mar=c(4,3.75,0.5,0.5), mgp=c(2.7,0.7,0), las = 1)#
normTail(mu, se, U = xbar, col="#22558833", axes = FALSE)#
axis(1, at = c(mu - 3*se, mu, xbar, mu+3*se), labels = c(NA, 22, 23.07, NA))
se = s / sqrt(n)#
mu = 22
par(mar=c(4,3.75,0.5,0.5), mgp=c(2.7,0.7,0), las = 1)#
normTail(mu, se, U = xbar, col="#22558833", axes = FALSE)#
axis(1, at = c(mu - 3*se, mu, xbar, mu+3*se), labels = c(NA, 22, 23.07, NA))
n = length(samp)#
#
xbar = mean(samp)#
#
s = sd(samp)
par(mar=c(4,3.75,0.5,0.5), mgp=c(2.7,0.7,0), las = 1)#
normTail(mu, se, U = xbar, col="#22558833", axes = FALSE)#
axis(1, at = c(mu - 3*se, mu, xbar, mu+3*se), labels = c(NA, 22, 23.07, NA))
xbar
age_at_marr = fwfdata$FMAR1AGE[!is.na(fwfdata$FMAR1AGE)]#
#
set.seed(8537)#
samp_age = sample(age_at_marr, size = 150, replace = FALSE)#
#
n = length(samp_age)#
#
xbar = mean(samp_age)#
#
s = sd(samp_age)
pdf("age_at_marr_hist.pdf", height = 3, width = 5)#
par(mar=c(4,3.75,0.5,0.5), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "age at first marriage of females", main = "")#
dev.off()
set.seed(8537)#
samp_age = sample(age_at_marr, size = 150, replace = FALSE)
age_at_marr = fwfdata$FMAR1AGE[!is.na(fwfdata$FMAR1AGE)]
setwd("/Users/mine/Desktop/Teaching/Sta 101 - S12/Exams/Midterm 1/figures/age_at_marr")
codebook <- read.table('clipboard.txt', sep=',', as.is=TRUE) #
#
## get number of rows in code book #
nr <- nrow(codebook) #
## provide names for codebook layout data frame #
names(codebook) <- c('variable','begin','end','type') #
#
## compute number of columns to read (and skip) for each variable #
## store in the vector read.col #
# compute field widths #
codebook$width <- codebook$end - codebook$begin + 1 #
#
# compute columns to skip between end of one field and #
# beginning of next field #
codebook$skip <- c(codebook$begin[-1]-codebook$end[-nr]-1,0) #
#
## create zero length numeric vector for holding column widths #
## (required by read.fwf) to read and skip, and populate the vector #
read.col <- numeric() #
for(i in 1:nr){ #
  read.col <- c(read.col,codebook$width[i]) #
  if(codebook$skip[i] > 0) read.col <- c(read.col,-codebook$skip[i]) #
} #
#
## recode type values to R classes #
codebook$Rtype <- ifelse(codebook$type %in% c('int','float'),'numeric', 'character') #
#
## now read in the data #
fwfdata <- read.fwf('2006_2010_FemResp.dat', col.names=codebook$variable, widths=read.col, colClasses=codebook$Rtype)
age_at_marr = fwfdata$FMAR1AGE[!is.na(fwfdata$FMAR1AGE)]#
#
set.seed(8537)#
samp_age = sample(age_at_marr, size = 150, replace = FALSE)#
#
n = length(samp_age)#
#
xbar = mean(samp_age)#
#
s = sd(samp_age)#
#
pdf("age_at_marr_hist.pdf", height = 3, width = 5)#
par(mar=c(4,3.75,0.5,0.5), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "age at first marriage of females", main = "")#
dev.off()
se = s / sqrt(n)#
mu = 22#
#
pdf("age_at_marr_pval.pdf", height = 3, width = 5)#
par(mar=c(4,3.75,0.5,0.5), mgp=c(2.7,0.7,0), las = 1)#
normTail(mu, se, U = xbar, col="#22558833", axes = FALSE)#
axis(1, at = c(mu - 3*se, mu, xbar, mu+3*se), labels = c(NA, 22, 23.07, NA))#
dev.off()
23.07-22
1/07/se
1.07/se
s
xbar
4.41/sqrt(150)
1.07/.36
1 -  0.9985
#
pdf("age_at_marr_pval.pdf", height = 3, width = 5)#
par(mar=c(4,3.75,0.5,0.5), mgp=c(2.7,0.7,0), las = 1)#
normTail(mu, se, U = xbar, col="#22558833", axes = FALSE)#
axis(1, at = c(mu - 3*se, mu, xbar, mu+3*se), labels = c(NA, 22, 23.07, NA), cex.axis = 1.25)#
dev.off()
load("/Users/mine/Desktop/Teaching/Sta 101 - S12/Exams/Midterm 1/figures/survey/survey.Rdata")
names(survey)
hist(survey$fb_check)
hist(survey$sexual_partners)
hist(survey$countries)
hist(survey$go_home)
table(survey$cheat)
table(survey$cheat, survey$gender)
sum(table(survey$cheat, survey$gender))
setwd("/Users/mine/Desktop/Teaching/Sta 101 - S12/Exams/Midterm 1/figures/cheat")
xtable(table(survey$cheat, survey$gender))
library(xtable)
xtable(table(survey$cheat, survey$gender))
barplot(table(survey$cheat, survey$gender))
barplot(table(survey$cheat, survey$gender)/204)
mosaicplot(table(survey$cheat, survey$gender))
par(mar=c(2,0,0,0), mgp=c(2.7,0.7,0), las = 1)#
barplot(table(survey$cheat, survey$gender), col = c("#225588", "white"), legend = TRUE)
par(mar=c(4,1,0,0), mgp=c(2.7,0.7,0), las = 1)#
barplot(table(survey$cheat, survey$gender), col = c("#22558833", "white"), legend = TRUE, main = "")
par(mar=c(2,4,0,0), mgp=c(2.7,0.7,0), las = 1)#
barplot(table(survey$cheat, survey$gender), col = c("#22558833", "white"), legend = TRUE, main = "")
par(mar=c(2,4,1,0), mgp=c(2.7,0.7,0), las = 1)#
barplot(table(survey$cheat, survey$gender), col = c("#22558833", "white"), legend = TRUE, main = "")
par(mar=c(2,4,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$cheat, survey$gender), col = c("#22558833"), main = "")
par(mar=c(2,2,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$cheat, survey$gender), col = c("#22558833"), main = "")
par(mar=c(2,1,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$cheat, survey$gender), col = c("#22558833"), main = "")
par(mar=c(1,1,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$cheat, survey$gender), col = c("#22558833"), main = "")
par(mar=c(1,1,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$cheat, survey$gender), col = c("#22558833"), main = "", cex.lab = 1.5)
#
pdf("cheat_mos.pdf", height = 3.5, width = 5)#
par(mar=c(1,1,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$cheat, survey$gender), col = c("#22558833"), main = "", cex.lab = 1.5)#
dev.off()
par(mar=c(3,4,1,0), mgp=c(2.7,0.7,0), las = 1)#
barplot(table(survey$cheat, survey$gender), col = c("#22558833", "white"), legend = TRUE, main = "", xlab = "Plot A")
par(mar=c(5,4,1,0), mgp=c(2.7,0.7,0), las = 1)#
barplot(table(survey$cheat, survey$gender), col = c("#22558833", "white"), legend = TRUE, main = "", xlab = "Plot A")
barplot(table(survey$cheat, survey$gender), col = c("#22558833", "white"), legend = TRUE, main = "", xlab = "Plot A", cex.lab = 1.5)
par(mar=c(5,1,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$cheat, survey$gender), col = c("#22558833"), main = "", cex.lab = 1.5, , xlab = "Plot B", cex.lab = 1.5)
par(mar=c(3,1,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$cheat, survey$gender), col = c("#22558833"), main = "", cex.lab = 1.5, , xlab = "Plot B", cex.lab = 1.5)
par(mar=c(2,1,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$cheat, survey$gender), col = c("#22558833"), main = "", cex.lab = 1.5, , xlab = "Plot B", cex.lab = 1.5)
barplot(table(survey$cheat, survey$gender), col = c("#22558833", "white"), legend = TRUE, main = "", xlab = "Plot A", cex.lab = 1.5)
par(mar=c(5,4,1,0), mgp=c(2.7,0.7,0), las = 1)#
barplot(table(survey$cheat, survey$gender), col = c("#22558833", "white"), legend = TRUE, main = "", xlab = "Plot A", cex.lab = 1.5)
par(mar=c(4,4,1,0), mgp=c(2.7,0.7,0), las = 1)#
barplot(table(survey$cheat, survey$gender), col = c("#22558833", "white"), legend = TRUE, main = "", xlab = "Plot A", cex.lab = 1.5)
par(mar=c(2,1,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$cheat, survey$gender), col = c("#22558833"), main = "", cex.lab = 1.5, , xlab = "Plot B", cex.lab = 1.5)
#
pdf("cheat_bar.pdf", height = 3.5, width = 5)#
par(mar=c(4,4,1,0), mgp=c(2.7,0.7,0), las = 1)#
barplot(table(survey$cheat, survey$gender), col = c("#22558833", "white"), legend = TRUE, main = "", xlab = "Plot A")#
dev.off()
pdf("cheat_mos.pdf", height = 3.5, width = 5)#
par(mar=c(2,1,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$cheat, survey$gender), col = c("#22558833"), main = "", cex.lab = 1.5, , xlab = "Plot B")#
dev.off()
53/(53+91)
pdf("cheat_mos.pdf", height = 3.5, width = 5)#
par(mar=c(2,1,1,0), mgp=c(2.7,0.7,0), las = 1)#
mosaicplot(table(survey$gender, survey$cheat), col = c("#22558833"), main = "", cex.lab = 1.5, , xlab = "Plot B")#
dev.off()
0.6^7 + 7 * 0.4 * 0.6^6
setwd("/Users/mine/Desktop/Teaching/Sta 101 - S12/Exams/Midterm 1/figures/scores")#
#
set.seed(7563)#
a  = rbeta(10000, 4.5, 2)#
b = a * 95#
#
pdf("scores_pop.pdf", height = 3.5, width = 5)#
par(mar=c(2,0,0,0), mgp=c(2.7,0.7,0), las = 1)#
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")#
axis(1)#
text(x = 10, y = 0.015, "Population")#
text(x = 10, y = 0.0125, expression(paste(mu, " = 66")))#
text(x = 10, y = 0.01, expression(paste(sigma, " = 16")))#
dev.off()#
#
####
#
set.seed(2452)#
samp = sample(b, size = 500)#
#
pdf("scores_samp.pdf", height = 3, width = 5)#
par(mar=c(2,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "Plot A", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()#
#
####
#
set.seed(24524)#
#
sampling_16 = rep(0, 500)#
n = 16#
#
for(i in 1:500){#
  	temp <- sample(b, n)#
   	sampling_16[i] <- mean(temp)#
   	}#
#
pdf("scores_sampling_16.pdf", height = 3, width = 5)#
par(mar=c(2,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_16, col="#22558833", border="#225588", xlab = "Plot B", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()#
#
####
#
set.seed(3563)#
#
sampling_64 = rep(0, 500)#
n = 64#
#
for(i in 1:500){#
  	temp <- sample(b, n)#
   	sampling_64[i] <- mean(temp)#
   	}#
#
pdf("scores_sampling_64.pdf", height = 3, width = 5)#
par(mar=c(2,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_64, col="#22558833", border="#225588", xlab = "Plot C", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()
library(openintro)#
#
setwd("/Users/mine/Desktop/Teaching/Sta 101 - S12/Exams/Midterm 1/figures/scores")#
#
set.seed(7563)#
a  = rbeta(10000, 4.5, 2)#
b = a * 95#
#
pdf("scores_pop.pdf", height = 3.5, width = 5)#
par(mar=c(4,0,0,0), mgp=c(2.7,0.7,0), las = 1)#
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")#
axis(1)#
text(x = 10, y = 0.015, "Population")#
text(x = 10, y = 0.0125, expression(paste(mu, " = 66")))#
text(x = 10, y = 0.01, expression(paste(sigma, " = 16")))#
dev.off()#
#
####
#
set.seed(2452)#
samp = sample(b, size = 500)#
#
pdf("scores_samp.pdf", height = 3, width = 5)#
par(mar=c(4,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "Plot A", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()#
#
####
#
set.seed(24524)#
#
sampling_16 = rep(0, 500)#
n = 16#
#
for(i in 1:500){#
  	temp <- sample(b, n)#
   	sampling_16[i] <- mean(temp)#
   	}#
#
pdf("scores_sampling_16.pdf", height = 3, width = 5)#
par(mar=c(4,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_16, col="#22558833", border="#225588", xlab = "Plot B", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()#
#
####
#
set.seed(3563)#
#
sampling_64 = rep(0, 500)#
n = 64#
#
for(i in 1:500){#
  	temp <- sample(b, n)#
   	sampling_64[i] <- mean(temp)#
   	}#
#
pdf("scores_sampling_64.pdf", height = 3, width = 5)#
par(mar=c(2,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_64, col="#22558833", border="#225588", xlab = "Plot C", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()
par(mar=c(3,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_64, col="#22558833", border="#225588", xlab = "Plot C", main = "", cex.axis = 1.5, cex.lab = 1.5)
library(openintro)#
#
setwd("/Users/mine/Desktop/Teaching/Sta 101 - S12/Exams/Midterm 1/figures/scores")#
#
set.seed(7563)#
a  = rbeta(10000, 4.5, 2)#
b = a * 95#
#
pdf("scores_pop.pdf", height = 3.5, width = 5)#
par(mar=c(4,0,0,0), mgp=c(2.7,0.7,0), las = 1)#
densityPlot(b, bw = 5, from = 0, to = 101, col = "#225588", fadingBorder = "33", histo = "faded", xlab = "", axes = FALSE, ylab = "")#
axis(1)#
text(x = 10, y = 0.015, "Population")#
text(x = 10, y = 0.0125, expression(paste(mu, " = 66")))#
text(x = 10, y = 0.01, expression(paste(sigma, " = 16")))#
dev.off()#
#
####
#
set.seed(2452)#
samp = sample(b, size = 500)#
#
pdf("scores_samp.pdf", height = 3, width = 5)#
par(mar=c(4,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(samp, col="#22558833", border="#225588", xlab = "Plot A", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()#
#
####
#
set.seed(24524)#
#
sampling_16 = rep(0, 500)#
n = 16#
#
for(i in 1:500){#
  	temp <- sample(b, n)#
   	sampling_16[i] <- mean(temp)#
   	}#
#
pdf("scores_sampling_16.pdf", height = 3, width = 5)#
par(mar=c(4,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_16, col="#22558833", border="#225588", xlab = "Plot B", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()#
#
####
#
set.seed(3563)#
#
sampling_64 = rep(0, 500)#
n = 64#
#
for(i in 1:500){#
  	temp <- sample(b, n)#
   	sampling_64[i] <- mean(temp)#
   	}#
#
pdf("scores_sampling_64.pdf", height = 3, width = 5)#
par(mar=c(4,4,0.5,0.25), mgp=c(2.7,0.7,0), las = 1)#
hist(sampling_64, col="#22558833", border="#225588", xlab = "Plot C", main = "", cex.axis = 1.5, cex.lab = 1.5)#
dev.off()
2.8-1.7
2.8+1.1
1.11.96
1.1/1.96
(1.1/1.96)*sqrt(499)
2.8 - 1.96 * 12.5/sqrt(499)
2.8 - 1.96 * 3/sqrt(499)
365*.4
365*.6
sqrt(365*.6*.4)
(99.5-146)/9.36
(149.5-146)/9.36
1 -  0.6443
2+2+3+2
2+4+5+2
2+2
2+2+5
2+4+2
2+2
2
9+13+8+4+2
par(mar=c(4,3.75,0.5,0.5), mgp=c(2.7,0.7,0), las = 1)#
hist(samp_age, col="#22558833", border="#225588", xlab = "age at first marriage of females", main = "")
q()
